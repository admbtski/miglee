# Join Form Queries

query EventJoinQuestions($eventId: ID!) {
  eventJoinQuestions(eventId: $eventId) {
    id
    eventId
    order
    type
    label
    helpText
    required
    options
    maxLength
    createdAt
    updatedAt
  }
}

query EventJoinRequests($eventId: ID!, $limit: Int = 20, $offset: Int = 0) {
  eventJoinRequests(eventId: $eventId, limit: $limit, offset: $offset) {
    items {
      member {
        id
        eventId
        userId
        role
        status
        joinedAt
        note
        rejectReason
        user {
          id
          name
          verifiedAt
          avatarKey
          avatarBlurhash
          profile {
            id
            bioShort
            city
            country
          }
        }
      }
      answers {
        id
        eventId
        userId
        questionId
        answer
        createdAt
        updatedAt
        question {
          id
          order
          type
          label
          helpText
          required
          options
          maxLength
        }
      }
    }
    pageInfo {
      total
      limit
      offset
      hasNext
      hasPrev
    }
  }
}

query MyJoinRequests(
  $status: EventMemberStatus
  $limit: Int = 20
  $offset: Int = 0
) {
  myJoinRequests(status: $status, limit: $limit, offset: $offset) {
    id
    eventId
    userId
    role
    status
    joinedAt
    leftAt
    note
    rejectReason
    event {
      id
      title
      description
      startAt
      endAt
      joinedCount
      max
      isFull
      owner {
        id
        name
        verifiedAt
        avatarKey
        avatarBlurhash
      }
    }
    joinAnswers {
      id
      questionId
      answer
      question {
        id
        label
        type
      }
    }
  }
}

mutation RequestJoinEventWithAnswers($input: RequestJoinEventInput!) {
  requestJoinEventWithAnswers(input: $input) {
    id
    title
    joinedCount
    max
    isFull
  }
}

mutation ApproveJoinRequest($input: ApproveJoinRequestInput!) {
  approveJoinRequest(input: $input) {
    id
    title
    joinedCount
    max
    isFull
  }
}

mutation RejectJoinRequest($input: RejectJoinRequestInput!) {
  rejectJoinRequest(input: $input) {
    id
    title
  }
}

mutation CancelJoinRequest($eventId: ID!) {
  cancelJoinRequest(eventId: $eventId)
}
