# Join Form Queries

query IntentJoinQuestions($intentId: ID!) {
  intentJoinQuestions(intentId: $intentId) {
    id
    intentId
    order
    type
    label
    helpText
    required
    options
    maxLength
    createdAt
    updatedAt
  }
}

query IntentJoinRequests($intentId: ID!, $limit: Int = 20, $offset: Int = 0) {
  intentJoinRequests(intentId: $intentId, limit: $limit, offset: $offset) {
    items {
      member {
        id
        intentId
        userId
        role
        status
        joinedAt
        note
        rejectReason
        user {
          id
          name
          verifiedAt
          avatarKey
          avatarBlurhash
          profile {
            id
            bioShort
            city
            country
          }
        }
      }
      answers {
        id
        intentId
        userId
        questionId
        answer
        createdAt
        updatedAt
        question {
          id
          order
          type
          label
          helpText
          required
          options
          maxLength
        }
      }
    }
    pageInfo {
      total
      limit
      offset
      hasNext
      hasPrev
    }
  }
}

query MyJoinRequests(
  $status: IntentMemberStatus
  $limit: Int = 20
  $offset: Int = 0
) {
  myJoinRequests(status: $status, limit: $limit, offset: $offset) {
    id
    intentId
    userId
    role
    status
    joinedAt
    leftAt
    note
    rejectReason
    intent {
      id
      title
      description
      startAt
      endAt
      joinedCount
      max
      isFull
      owner {
        id
        name
        verifiedAt
        avatarKey
        avatarBlurhash
      }
    }
    joinAnswers {
      id
      questionId
      answer
      question {
        id
        label
        type
      }
    }
  }
}

# Join Form Mutations (deprecated - individual operations)
# Use UpdateIntentJoinQuestions for bulk replace instead

# mutation CreateJoinQuestion($input: CreateJoinQuestionInput!) {
#   createJoinQuestion(input: $input) {
#     id
#     intentId
#     order
#     type
#     label
#     helpText
#     required
#     options
#     maxLength
#     createdAt
#     updatedAt
#   }
# }

# mutation UpdateJoinQuestion($id: ID!, $input: UpdateJoinQuestionInput!) {
#   updateJoinQuestion(id: $id, input: $input) {
#     id
#     intentId
#     order
#     type
#     label
#     helpText
#     required
#     options
#     maxLength
#     createdAt
#     updatedAt
#   }
# }

# mutation DeleteJoinQuestion($id: ID!) {
#   deleteJoinQuestion(id: $id)
# }

# mutation ReorderJoinQuestions($intentId: ID!, $questionIds: [ID!]!) {
#   reorderJoinQuestions(intentId: $intentId, questionIds: $questionIds) {
#     id
#     intentId
#     order
#     type
#     label
#     helpText
#     required
#     options
#     maxLength
#     createdAt
#     updatedAt
#   }
# }

mutation RequestJoinIntentWithAnswers($input: RequestJoinIntentInput!) {
  requestJoinIntentWithAnswers(input: $input) {
    id
    title
    joinedCount
    max
    isFull
  }
}

mutation ApproveJoinRequest($input: ApproveJoinRequestInput!) {
  approveJoinRequest(input: $input) {
    id
    title
    joinedCount
    max
    isFull
  }
}

mutation RejectJoinRequest($input: RejectJoinRequestInput!) {
  rejectJoinRequest(input: $input) {
    id
    title
  }
}

mutation CancelJoinRequest($intentId: ID!) {
  cancelJoinRequest(intentId: $intentId)
}
