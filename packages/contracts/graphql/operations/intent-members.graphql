# =============================================================================
# Intent Membership Mutations (User Actions)
# =============================================================================

# User requests to join an intent
mutation RequestJoinIntent($intentId: ID!) {
  requestJoinIntent(intentId: $intentId) {
    ...IntentCore
  }
}

# User cancels their join request
mutation CancelJoinRequest($intentId: ID!) {
  cancelJoinRequest(intentId: $intentId)
}

# User leaves an intent they've joined
mutation LeaveIntent($intentId: ID!) {
  leaveIntent(intentId: $intentId) {
    ...IntentCore
  }
}

# User accepts an invitation to join
mutation AcceptInvite($intentId: ID!) {
  acceptInvite(intentId: $intentId) {
    ...IntentCore
  }
}

# =============================================================================
# Waitlist Mutations (User Actions)
# =============================================================================

# User joins the waitlist for a full OPEN event
mutation JoinWaitlistOpen($intentId: ID!) {
  joinWaitlistOpen(intentId: $intentId) {
    ...IntentCore
  }
}

# User leaves the waitlist
mutation LeaveWaitlist($intentId: ID!) {
  leaveWaitlist(intentId: $intentId)
}

# =============================================================================
# Intent Membership Mutations (Owner/Moderator Actions)
# =============================================================================

# Owner/moderator invites a user to join
mutation InviteMember($input: InviteMemberInput!) {
  inviteMember(input: $input) {
    ...IntentCore
  }
}

# Owner/moderator approves a pending join request
mutation ApproveMembership($input: ApproveMembershipInput!) {
  approveMembership(input: $input) {
    ...IntentCore
  }
}

# Owner/moderator rejects a join request
mutation RejectMembership($input: RejectMembershipInput!) {
  rejectMembership(input: $input) {
    ...IntentCore
  }
}

# Owner/moderator kicks a member
mutation KickMember($input: KickMemberInput!) {
  kickMember(input: $input) {
    ...IntentCore
  }
}

# Owner/moderator bans a member (permanent block)
mutation BanMember($input: BanMemberInput!) {
  banMember(input: $input) {
    ...IntentCore
  }
}

mutation UnbanMember($input: UnbanMemberInput!) {
  unbanMember(input: $input) {
    ...IntentCore
  }
}

# Owner/moderator cancels a pending or invited membership
mutation CancelPendingOrInviteForUser(
  $input: CancelPendingOrInviteForUserInput!
) {
  cancelPendingOrInviteForUser(input: $input)
}

# Owner/moderator updates a member's role (OWNER / MODERATOR / PARTICIPANT)
mutation UpdateMemberRole($input: UpdateMemberRoleInput!) {
  updateMemberRole(input: $input) {
    ...IntentCore
  }
}

# Owner/moderator manually promotes a user from waitlist to joined
mutation PromoteFromWaitlist($input: PromoteFromWaitlistInput!) {
  promoteFromWaitlist(input: $input) {
    ...IntentCore
  }
}

# =============================================================================
# Intent Membership Queries
# =============================================================================

# List members of an intent (with filtering)
query GetIntentMembers(
  $intentId: ID!
  $status: IntentMemberStatus
  $role: IntentMemberRole
  $limit: Int = 50
  $offset: Int = 0
) {
  intentMembers(
    intentId: $intentId
    status: $status
    role: $role
    limit: $limit
    offset: $offset
  ) {
    ...IntentMemberCore
  }
}

# Get a single membership
query GetIntentMember($intentId: ID!, $userId: ID!) {
  intentMember(intentId: $intentId, userId: $userId) {
    ...IntentMemberCore
  }
}

# Get current user's memberships across all intents
query GetMyMemberships(
  $status: IntentMemberStatus
  $role: IntentMemberRole
  $limit: Int = 50
  $offset: Int = 0
) {
  myMemberships(status: $status, role: $role, limit: $limit, offset: $offset) {
    ...IntentMemberCore
  }
}

# Get current user's intents with flexible filtering (membership + intent lifecycle status)
query GetMyIntents(
  $role: IntentMemberRole
  $membershipStatus: IntentMemberStatus
  $intentStatuses: [IntentLifecycleStatus!]
  $limit: Int = 50
  $offset: Int = 0
) {
  myIntents(
    role: $role
    membershipStatus: $membershipStatus
    intentStatuses: $intentStatuses
    limit: $limit
    offset: $offset
  ) {
    ...IntentMemberCore
    intent {
      ...IntentCore
    }
  }
}

# Get membership statistics for an intent
query GetIntentMemberStats($intentId: ID!) {
  intentMemberStats(intentId: $intentId) {
    joined
    pending
    invited
    rejected
    banned
    left
    kicked
  }
}
