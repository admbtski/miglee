fragment SessionUserCore on SessionUser {
  id
  name
  email
  role
  imageUrl
  verifiedAt
}

fragment UserCore on User {
  id
  email
  name
  role
  imageUrl
  verifiedAt
  createdAt
  updatedAt
  lastSeenAt
}

fragment CategoryCore on Category {
  id
  slug
  names # JSONObject with translated labels by locale
  icon
  color
  createdAt
  updatedAt
}

fragment TagCore on Tag {
  id
  label
  slug
  createdAt
  updatedAt
}

fragment IntentMemberCore on IntentMember {
  id
  role
  status
  joinedAt
  leftAt
  note
  user {
    ...UserCore
  }
  addedBy {
    id
    name
    imageUrl
  }
}

fragment IntentCore on Intent {
  id
  title
  description
  notes

  visibility
  mode
  min
  max

  startAt
  endAt
  allowJoinLate

  meetingKind
  onlineUrl

  lat
  lng
  address
  placeId
  radiusKm

  levels

  # computed helpers (resolver-calculated)
  joinedCount
  isFull
  hasStarted
  hasEnded
  canceledAt
  canceledBy {
    ...UserCore
  }
  cancelReason
  isCanceled

  createdAt
  updatedAt

  categories {
    ...CategoryCore
  }
  tags {
    ...TagCore
  }

  # convenience relations (resolver-calculated / access-controlled)
  owner {
    ...UserCore
  }
  members {
    ...IntentMemberCore
  }
}

fragment NotificationCore on Notification {
  id
  kind
  title
  body
  data
  dedupeKey
  entityType
  entityId
  readAt
  createdAt

  recipient {
    ...UserCore
  }
  actor {
    ...UserCore
  }

  # convenience relation when entityType=INTENT
  intent {
    id
    title
    startAt
  }
}

fragment PageInfoCore on PageInfo {
  total
  limit
  offset
  hasNext
  hasPrev
}

fragment UsersResultCore on UsersResult {
  items {
    ...UserCore
  }
  pageInfo {
    ...PageInfoCore
  }
}

fragment IntentsResultCore on IntentsResult {
  items {
    ...IntentCore
  }
  pageInfo {
    ...PageInfoCore
  }
}
